<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PO・TORO 公式ポータル</title>
  <meta name="description" content="concept cafe PO・TORO（ポ・トロ）の総合ポータル。最新イベント、メイドさん紹介、アクセス、各種コンテンツへの入口をひとまとめ。" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="theme-color" content="#f6b7d2" />
  <link rel="apple-touch-icon" href="img/apple-touch-icon.png" />
  <!-- ここを実URLに -->
  <link rel="canonical" href="https://potoro1001.github.io/potoro-portal/" />

  <!-- OGP -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="PO・TORO 公式ポータル" />
  <meta property="og:description" content="concept cafe PO・TORO（ポ・トロ）の最新情報とリンク集。" />
  <meta property="og:image" content="https://potoro1001.github.io/potoro-portal/img/ogp.jpg" />
  <meta property="og:url" content="https://potoro1001.github.io/potoro-portal/" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="PO・TORO 公式ポータル" />
  <meta name="twitter:description" content="concept cafe PO・TORO（ポ・トロ）の最新情報とリンク集。" />
  <meta name="twitter:image" content="https://potoro1001.github.io/potoro-portal/img/ogp.jpg" />
  <style>
    :root{ --pink:#f6b7d2; --blue:#a9d6f7; --ink:#333; --card:#ffffffcc; --shadow:0 10px 30px rgba(0,0,0,.12); --bg-angle:135deg; --bg-a:var(--pink); --bg-b:var(--blue); }
    @supports (color: color(srgb 1 1 1)){
      :root{ --pink: color(srgb 0.9647 0.7176 0.8235); --blue: color(srgb 0.6627 0.8392 0.9686); }
      .btn-primary{ background:linear-gradient(135deg,color(srgb 1 0.5059 0.7529),color(srgb 0.5569 0.8235 1)); }
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;font-family:"-apple-system","BlinkMacSystemFont","Hiragino Kaku Gothic ProN","Noto Sans JP",Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji",sans-serif;color:var(--ink);background:linear-gradient(var(--bg-angle),var(--bg-a),var(--bg-b));background-attachment:fixed;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    a{color:#0b69d5;text-decoration:none}
    img{max-width:100%;height:auto;display:block}
    .container{width:min(1100px,92vw);margin:0 auto}

    header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(140%) blur(10px);background:rgba(255,255,255,.82);box-shadow:0 2px 12px rgba(0,0,0,.08)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:10px 14px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand-logo{width:40px;height:40px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff, #ffe2ee 60%, #ffd3ea 100%);display:grid;place-items:center;box-shadow:var(--shadow)}
    .brand-logo span{font-weight:900;color:#ff5ea8}
    .brand-title{font-weight:800;letter-spacing:.08em}
    .brand-title .en{font-size:1.05rem}
    .brand-title .jp{font-size:.8rem;color:#666}

    .nav-links{display:flex;gap:14px;align-items:center}
    .nav-links a{padding:10px 14px;border-radius:999px;background:rgba(255,255,255,.98);box-shadow:0 4px 12px rgba(0,0,0,.08);font-size:1rem;font-weight:800;color:#222;border:1px solid #eaeaea;letter-spacing:.02em;outline:none}
    .nav-links a:hover{background:#111;color:#fff;box-shadow:0 6px 16px rgba(0,0,0,.18)}
    .nav-links a:focus-visible{outline:2px solid #0b69d5;outline-offset:2px}

    .hamburger{display:none;background:#fff;border:none;border-radius:12px;padding:9px;box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .hamburger svg{width:22px;height:22px}
    @media (max-width:880px){
      .nav-links{display:none}
      .hamburger{display:inline-grid}
      .drawer{position:fixed;inset:0 0 0 auto;width:min(84vw,360px);background:#fff;box-shadow:-20px 0 40px rgba(0,0,0,.18);transform:translateX(100%);transition:transform .28s ease;z-index:60;display:flex;flex-direction:column}
      .drawer.open{transform:translateX(0)}
      .drawer .head{display:flex;align-items:center;justify-content:space-between;padding:16px}
      .drawer a{padding:16px 20px;border-bottom:1px solid #eee;font-size:1.05rem;font-weight:800;color:#222;letter-spacing:.02em}
    }

    .hero{position:relative;isolation:isolate}
    .hero .wrap{display:grid;grid-template-columns:1.2fr .8fr;gap:24px;align-items:center;padding:40px 0}
    .badge{display:inline-flex;gap:8px;align-items:center;background:#fff;border-radius:999px;padding:6px 10px;box-shadow:var(--shadow);font-size:.85rem}
    .headline{font-size:clamp(1.6rem,4vw,2.6rem);line-height:1.16;margin:.4rem 0 .2rem;font-weight:900;letter-spacing:.02em}
    .sub{color:#444;margin:.2rem 0 1rem}
    .cta{display:flex;flex-wrap:wrap;gap:10px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 16px;border-radius:14px;border:none;font-weight:700;cursor:pointer;box-shadow:var(--shadow)}
    .btn-primary{background:linear-gradient(135deg,#ff81c0,#8ed2ff);color:#fff}
    .btn-ghost{background:#fff;color:#333}
    .hero-card{background:var(--card);backdrop-filter: blur(8px);padding:14px;border-radius:14px;box-shadow:var(--shadow)}
    .hero-kv{width:100%;height:auto;object-fit:contain;background:#fff;border-radius:12px}

    section{padding:34px 0}
    .sec-title{font-weight:900;font-size:1.3rem;margin:0 0 14px 0;display:flex;align-items:center;gap:8px}
    .ticker{background:#fff;border-radius:14px;box-shadow:var(--shadow);overflow:hidden}
    .ticker ul{list-style:none;margin:0;padding:0}
    .ticker li{display:flex;gap:10px;align-items:center;padding:10px 12px;border-bottom:1px solid #eee}
    .ticker time{font-variant-numeric:tabular-nums;color:#666;min-width:7.7em}
    .label{display:inline-block;padding:.2em .6em;border-radius:999px;font-size:.75rem;font-weight:700;color:#fff;background:#ff72b4}

    .grid{display:grid;gap:16px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .grid.cols-4{grid-template-columns:repeat(4,1fr)}
    @media (max-width:1024px){.grid.cols-4{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:880px){.grid.cols-4,.grid.cols-3{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.grid.cols-4,.grid.cols-3{grid-template-columns:1fr}}

    .card{background:#fff;border-radius:18px;box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column}
    .card .thumb{aspect-ratio:16/9;background:#f4f4f4;object-fit:cover}
    .card .body{padding:12px 14px}
    .card h3{margin:.2rem 0 .4rem;font-size:1.05rem}
    .card p{margin:0;color:#555;font-size:.92rem}
    .chip{display:inline-flex;align-items:center;gap:6px;background:#fafafa;border:1px solid #eee;border-radius:999px;padding:4px 8px;font-size:.78rem}

    .qlink{display:flex;flex-direction:column;gap:10px;align-items:center;justify-content:center;text-align:center;background:#fff;border-radius:18px;box-shadow:var(--shadow);padding:18px;min-height:120px}

    .table{width:100%;border-collapse:collapse;background:#fff;border-radius:14px;box-shadow:var(--shadow);overflow:hidden}
    .table th,.table td{padding:12px;border-bottom:1px solid #eee;text-align:left}
    .table th{background:#fafafa}

    footer{padding:28px 0;color:#333}
    .foot{display:grid;gap:16px;grid-template-columns:2fr 1fr 1fr}
    .foot h4{margin:.2rem 0 .6rem}
    .sns{display:flex;gap:10px}
    .copyright{margin-top:12px;font-size:.85rem;color:#555}
    @media (max-width:880px){.foot{grid-template-columns:1fr}}

    .hidden{display:none}
    .mt-8{margin-top:8px}.mt-12{margin-top:12px}.mt-16{margin-top:16px}.mt-24{margin-top:24px}
    .tag{font-size:.75rem;color:#666}

    /* 「開発ログのみ非表示」：可視テキストは非表示、DOMには残す（アクセシブルに） */
    .devlog{
      position:absolute !important;
      width:1px!important;height:1px!important;
      margin:-1px!important;padding:0!important;border:0!important;
      clip:rect(0 0 0 0)!important;clip-path:inset(50%)!important;
      overflow:hidden!important;white-space:nowrap!important;
      opacity:0!important;pointer-events:none!important;
    }

    /* ライトボックス */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;align-items:center;justify-content:center;padding:4vw;z-index:100;opacity:0;pointer-events:none;transition:.2s}
    .lightbox.open{opacity:1;pointer-events:auto}
    .lightbox img{max-width:100%;max-height:100%;object-fit:contain;box-shadow:0 8px 30px rgba(0,0,0,.5);border-radius:10px}
    .lightbox .close{position:absolute;top:16px;right:16px;background:#fff;border:none;border-radius:999px;font-size:16px;padding:8px 12px;cursor:pointer}

    /* モーダル */
    .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:120;opacity:0;pointer-events:none;transition:.2s}
    .modal.open{opacity:1;pointer-events:auto}
    .modal .panel{width:min(880px,92vw);max-height:min(80vh,900px);overflow:auto;background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:18px}
    .modal .panel h2{margin:.4rem 0 0.6rem;font-size:1.3rem}
    .modal .close{position:sticky;top:0;margin-left:auto;background:#f6f6f6;border:none;border-radius:999px;padding:8px 12px;cursor:pointer}
    .modal .body{padding:8px 4px}

    .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{left:16px;top:12px;width:auto;height:auto;background:#111;color:#fff;padding:10px 12px;border-radius:10px;z-index:1000}
    :focus-visible{outline:2px solid #0b69d5;outline-offset:2px}

    @media (prefers-reduced-motion: reduce){*{scroll-behavior:auto !important;animation:none !important;transition:none !important}}

    @media (prefers-color-scheme: dark){
      :root{--ink:#eee}
      html,body{color:var(--ink);}
      header{background:rgba(20,20,20,.78)}
      .nav-links a{background:rgba(255,255,255,.1);color:#fff;border-color:rgba(255,255,255,.2);text-shadow:none}
      .nav-links a:hover{background:#fff;color:#111}
      .card,.qlink,.table{background:#1d1f22;color:#e8e8e8}
      .table th{background:#232529}
      .ticker,.hero-card{background:rgba(255,255,255,.08)}
    }

    @media (max-width:768px){ html,body{background-attachment:scroll} }

    @supports (-webkit-touch-callout: none) {
      @media (pointer: coarse) {
        .qlink{background:#fff !important;color:#111 !important;border:1px solid #eee !important;}
        .qlink strong{color:#111 !important}
        .qlink .tag{color:#555 !important}
        .table{background:#fff !important;color:#111 !important;border:1px solid #eee !important}
        .table th{background:#fafafa !important;color:#111 !important}
        .table td{color:#111 !important}
        .card{background:#fff !important;color:#111 !important;border:1px solid #eee !important}
        .card h3{color:#111 !important}
        .card p, .card a{color:#222 !important}
      }
    }
  </style>
</head>
<body>
  <a href="#news" class="skip-link">本文へスキップ</a>

  <header>
    <nav class="nav container" aria-label="Main">
      <div class="brand">
        <div class="brand-logo" aria-hidden="true"><span>PT</span></div>
        <div class="brand-title">
          <div class="en">concept cafe <span style="letter-spacing:.12em">PO・TORO</span></div>
          <div class="jp">ポ・トロ 公式ポータル</div>
        </div>
      </div>
      <div class="nav-links" id="navLinks">
        <a href="#news">お知らせ</a>
        <a href="#events">イベント</a>
        <a href="#maids">メイドさん紹介</a>
        <a href="#games">ゲーム/診断</a>
        <a href="#schedule">営業日</a>
        <a href="#access">アクセス</a>
        <a href="#sns">SNS</a>
      </div>
      <button class="hamburger" id="btnMenu" aria-label="メニューを開く" aria-controls="drawer" aria-expanded="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
    </nav>
    <div class="drawer" id="drawer" aria-hidden="true" aria-label="サイドメニュー">
      <div class="head">
        <div style="font-weight:800">メニュー</div>
        <button id="btnClose" aria-label="閉じる">✕</button>
      </div>
      <a href="#news">お知らせ</a>
      <a href="#events">イベント</a>
      <a href="#maids">メイドさん紹介</a>
      <a href="#games">ゲーム/診断</a>
      <a href="#schedule">営業日</a>
      <a href="#access">アクセス</a>
      <a href="#sns">SNS</a>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="hero">
      <div class="container wrap">
        <div>
          <span class="badge" aria-label="最新の更新">🔔 最新情報をチェック</span>
          <h1 class="headline">ようこそ、ご主人さま・お嬢さま。<br>PO・TOROの入口はここ♡</h1>
          <p class="sub">イベント、メイドさん紹介、ゲームや各種リンクをこのページに集約しました。ブックマーク推奨です！</p>
          <div class="cta">
            <a class="btn btn-primary" href="#events">イベント案内へ</a>
            <a class="btn btn-ghost" href="#games">診断・ゲームで遊ぶ</a>
          </div>
          <div class="hero-card mt-16" role="status">
            <strong>最新のお給仕予定表は公式Xをご覧ください♡</strong>
          </div>
        </div>
        <div class="hero-card">
          <a href="https://x.com/po_toro" target="_blank" rel="noopener noreferrer" aria-label="X（@po_toro）へのリンク"><img src="img/potro_twi.jpg" alt="PO・TORO キービジュアル（クリックでXへ）" class="thumb hero-kv" loading="lazy" width="1280" height="720" /></a>
        </div>
      </div>
    </section>

    <!-- News -->
    <section id="news">
      <div class="container">
        <h2 class="sec-title">🗞️ お知らせ</h2>
        <div class="ticker" aria-live="polite">
          <ul id="newsList"></ul>
        </div>
        <!-- 開発ログのみ非表示 -->
        <div id="newsStatus" class="tag devlog" aria-live="polite"></div>
      </div>
    </section>

    <!-- Events -->
    <section id="events">
      <div class="container">
        <h2 class="sec-title">🎉 イベント</h2>
        <div class="grid cols-3" id="eventsGrid"></div>
        <!-- 開発ログのみ非表示 -->
        <div id="eventsStatus" class="tag devlog" aria-live="polite"></div>
      </div>
    </section>

  <!-- メイドさん紹介 -->
<section id="maids">
  <div class="container">
    <h2 class="sec-title">👑 メイドさん紹介</h2>
    <div class="grid cols-2" style="align-items:start">
      
      <!-- 左：メイドプロフィール一覧 -->
      <article class="card">
        <img src="img/potro_cafe_maiddemo_final.png" alt="メイドさん紹介" class="thumb" loading="lazy">
        <div class="body">
          <h3>メイドさん紹介</h3>
          <p>PO♡TOROのメイドさんたち</p>
          <a class="btn btn-ghost" href="https://potoro1001.github.io/potoro-profile-public/" target="_blank" rel="noopener noreferrer">プロフィール一覧を見る</a>
        </div>
      </article>

      <!-- 右：歴代メイド服紹介 -->
      <article class="card">
        <img src="img/uniforms_thumbnail.jpg" alt="PO・TORO 歴代メイド服紹介" class="thumb" loading="lazy">
        <div class="body">
          <h3>歴代メイド服紹介</h3>
          <p>初代から六代目までのメイド服をご紹介♡</p>
          <a class="btn btn-ghost" href="uniforms.html" target="_blank" rel="noopener noreferrer">歴代メイド服を見る</a>
        </div>
      </article>

    </div>
  </div>
</section>

    <!-- Games / Tools -->
    <section id="games">
      <div class="container">
        <h2 class="sec-title">🎮 ゲーム / 診断 / 講義</h2>
        <div class="grid cols-4">
          <!-- ポトロクエスト：カード付き（B / 文字なし） -->
          <article class="card">
            <img src="img/hero-quest-card.png" alt="ポ・トロクエスト キービジュアル" class="thumb" loading="lazy" width="1280" height="720">
            <div class="body">
              <h3>ポ・トロクエスト</h3>
              <p class="tag">BOSSを討伐してチェキ券GET!?</p>
              <a class="btn btn-ghost" href="https://potoro1001.github.io/potoro-quest/" id="linkQuest" target="_blank" rel="noopener noreferrer">プレイする</a>
            </div>
          </article>

          <!-- ご主人様タイプ診断：カード付き（A / 文字なし） -->
          <article class="card">
           <img src="img/hero-diagnosis-card.png" alt="ご主人様タイプ診断 キービジュアル" class="thumb" loading="lazy" width="1280" height="720">
            <div class="body">
              <h3>ご主人様タイプ診断</h3>
              <p class="tag">MBTIミニ12問で性格診断</p>
              <a class="btn btn-ghost" href="https://potoro1001.github.io/potoro-diagnosis/" id="linkMBTI" target="_blank" rel="noopener noreferrer">診断する</a>
            </div>
          </article>
  
    <!-- 萌えセレクト講義：カード付き -->
<article class="card">
  <img src="img/moeselect_thumbnail.jpg" alt="萌えセレクト講義 キービジュアル" class="thumb" loading="lazy" width="1280" height="720">
  <div class="body">
    <h3>萌えセレクト講義</h3>
    <p class="tag">講義形式で学ぶ「萌え」の極意</p>
    <a class="btn btn-ghost" href="https://potoro1001.github.io/potoro-moeselect/" target="_blank" rel="noopener noreferrer">受講する</a>
  </div>
</article>
 </div>
  </div>
    </section>

    <!-- Schedule -->
    <section id="schedule">
      <div class="container">
        <h2 class="sec-title">📅 営業スケジュール（直近7日）</h2>
        <table class="table" aria-label="営業日と営業時間">
          <thead><tr><th>日付</th><th>営業時間</th><th>メモ</th></tr></thead>
          <tbody id="scheduleBody"></tbody>
        </table>
        <!-- 開発ログのみ非表示 -->
        <div id="scheduleStatus" class="tag devlog" aria-live="polite"></div>
      </div>
    </section>
    
    <!-- Access -->
    <section id="access">
      <div class="container">
        <h2 class="sec-title">📍 アクセス</h2>
        <div class="grid cols-3">
          <div class="card" style="grid-column: span 2;">
            <div class="body">
              <h3>店舗情報</h3>
              <p>〒790-0012 愛媛県松山市湊町3-7-2 2F</p>
              <p>営業時間：平日＆祝 18:00–22:00 / 土日 17:00–22:00</p>
              <p>料金：30分 1,000円(税込) 各種ドリンク飲み放題（生ビール含む）</p>
              <p class="tag">※放置ゼロ宣言＆キャストドリンク無しで安心♪</p>
            </div>
          </div>
          <div class="card">
            <div class="body">
              <h3>地図</h3>
              <div style="position:relative;width:100%;padding-top:56.25%;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,.12)">
                <iframe title="PO・TORO の場所" src="https://www.google.com/maps?q=33.8359588,132.7696145&z=18&output=embed" style="position:absolute;inset:0;border:0;width:100%;height:100%" loading="lazy" referrerpolicy="no-referrer-when-downgrade" allowfullscreen></iframe>
              </div>
              <p class="mt-12"><a href="https://www.google.com/maps/place/PO.TORO/@33.8358626,132.7688299,18.58z" target="_blank" rel="noopener noreferrer">Google マップで開く</a></p>
            </div>
          </div>
        </div>
      </div>
    </section>

   <!-- SNS -->
<section id="sns">
  <div class="container">
    <h2 class="sec-title">📡 公式SNS</h2>

    <!-- 2枚のSNSカード -->
    <div class="grid cols-3">
      <!-- X（旧Twitter） -->
      <article class="card">
        <img src="img/hero-sns-x.png" alt="PO・TORO 公式X（旧Twitter）" class="thumb" loading="lazy" width="1280" height="720">
        <div class="body">
          <h3>X（旧Twitter）</h3>
          <p class="tag">@po_toro</p>
          <a class="btn btn-ghost" href="https://x.com/po_toro" target="_blank" rel="noopener noreferrer" aria-label="X（@po_toro）へ">Xを開く</a>
        </div>
      </article>

      <!-- TikTok -->
      <article class="card">
        <img src="img/hero-sns-tiktok.png" alt="PO・TORO 公式TikTok" class="thumb" loading="lazy" width="1280" height="720">
        <div class="body">
          <h3>TikTok</h3>
          <p class="tag">@potoro_o</p>
          <a class="btn btn-ghost" href="https://www.tiktok.com/@potoro_o" target="_blank" rel="noopener noreferrer" aria-label="TikTok（@potoro_o）へ">TikTokを開く</a>
        </div>
      </article>
    </div>
  </div>
</section>

<!-- Recruit -->
<section id="recruit">
  <div class="container">
    <h2 class="sec-title">👗 メイドさん募集</h2>
    <div class="grid cols-1">
      <article class="card">
        <img src="img/recruit_banner.jpg" alt="メイドさん募集中" class="thumb" loading="lazy">
        <div class="body">
          <h3>メイドさん募集中</h3>
          <p>PO・TOROでは一緒に働くメイドさんを募集しています。未経験の方も大歓迎♡</p>
          <a class="btn btn-ghost" href="https://jp.indeed.com/job/%E3%83%A1%E3%82%A4%E3%83%89%E3%82%AB%E3%83%95%E3%82%A7%E3%82%B3%E3%83%B3%E3%82%BB%E3%83%97%E3%83%88%E3%82%AB%E3%83%95%E3%82%A7%E3%83%9B%E3%83%BC%E3%83%AB%E3%82%B9%E3%82%BF%E3%83%83%E3%83%95-3ad4b6a67e32b85c" target="_blank" rel="noopener noreferrer">応募ページへ</a>
        </div>
      </article>
    </div>
  </div>
</section>
  </main>

  <footer>
    <div class="container foot">
      <div>
        <h4>concept cafe PO・TORO</h4>
        <p>ご帰宅ありがとうございます。システムやイベントの最新情報は本ポータルからご確認ください。</p>
        <div class="copyright">© <span id="year"></span> PO・TORO / concept cafe. All rights reserved.</div>
      </div>
      <div>
        <h4>リンク</h4>
        <ul>
          <li><a href="#events">イベント</a></li>
          <li><a href="#maids">メイドさん紹介</a></li>
          <li><a href="#games">ゲーム/診断</a></li>
          <li><a href="#" id="openTerms">利用規約</a></li>
          <li><a href="#" id="openPrivacy">プライバシー</a></li>
        </ul>
      </div>
      <div>
        <h4>お問い合わせ</h4>
        <ul>
          <li><a href="https://x.com/po_toro" target="_blank" rel="noopener noreferrer">X（@po_toro）</a></li>
          <li><a href="#access">店舗アクセス</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- ライトボックス -->
  <div id="lightbox" class="lightbox" aria-hidden="true" role="dialog" aria-label="画像ビューア">
    <button type="button" class="close" aria-label="閉じる (Esc)">閉じる ✕</button>
    <img id="lightboxImg" alt="拡大画像" />
  </div>

  <!-- モーダル：利用規約 -->
  <div id="modalTerms" class="modal" aria-modal="true" tabindex="-1" role="dialog" aria-label="利用規約">
    <div class="panel">
      <button class="close" data-close="modalTerms" aria-label="閉じる">✕ 閉じる</button>
      <div class="body">
        <h2>利用規約</h2>
        <p>本ウェブサイトおよび関連コンテンツは、concept cafe PO・TORO（以下「当店」）が運営しています。ご利用にあたり、以下の規約に同意いただいたものとみなします。</p>
        <ul>
          <li>当店のコンテンツ（画像、文章、動画等）の著作権は当店または正当な権利者に帰属します。無断転載・使用を禁じます。</li>
          <li>当店は、予告なくサービス内容を変更・中止する場合があります。</li>
          <li>サイトの利用に関連して発生した損害について、当店は一切の責任を負いません。</li>
          <li>本規約は必要に応じて改訂される場合があります。最新の内容をご確認ください。</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- モーダル：プライバシー -->
  <div id="modalPrivacy" class="modal" aria-modal="true" tabindex="-1" role="dialog" aria-label="プライバシーポリシー">
    <div class="panel">
      <button class="close" data-close="modalPrivacy" aria-label="閉じる">✕ 閉じる</button>
      <div class="body">
        <h2>プライバシーポリシー</h2>
        <p>当店は、お客様の個人情報を適切に取り扱うことをお約束します。</p>
        <ul>
          <li>お問い合わせやご予約などの際に取得した個人情報は、応対およびサービス提供の目的のみに使用します。</li>
          <li>法令に基づく場合を除き、ご本人の同意なく第三者に提供することはありません。</li>
          <li>当店は取得した個人情報を安全に管理し、漏洩・改ざん・不正アクセス等の防止に努めます。</li>
          <li>クッキー（Cookie）やアクセス解析ツールを用いる場合がありますが、個人を特定する目的では利用しません。</li>
          <li>お客様がご自身の情報の開示・訂正・削除を希望される場合は、当店までご連絡ください。</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // 設定（CSV / GViz フォールバック）
    // =========================
    window.PORTAL_CONFIG = {
      newsCsvUrl:    "https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/export?format=csv&gid=1650494358",
      newsCsvUrlAlt: "https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/gviz/tq?tqx=out:csv&sheet=PORTAL_NEWS.csv",
      eventsCsvUrl:  "https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/export?format=csv&gid=365949763",
      eventsCsvUrlAlt:"https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/gviz/tq?tqx=out:csv&sheet=PORTAL_EVENTS.csv",
      scheduleCsvUrl:"https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/export?format=csv&gid=1276825118",
      scheduleCsvUrlAlt:"https://docs.google.com/spreadsheets/d/1rqajpwmrRffVgtfBS7fgvgyrCS7YgfkW5RyedstpDnw/gviz/tq?tqx=out:csv&sheet=PORTAL_schedule.csv"
    };

    // =========================
    // ユーティリティ
    // =========================
    function escapeHtml(str){ return String(str).replace(/[&<>]/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[s])); }
    function normalizeHeader(s){ let t=String(s||''); if(t && t.charCodeAt(0)===0xFEFF) t=t.slice(1); return t.trim().toLowerCase(); }

    // タイムアウト付きfetch（拡張機能介入・ハング対策）
    async function fetchTextWithTimeout(url, ms=10000){
      const controller = new AbortController();
      const id = setTimeout(()=>controller.abort(), ms);
      try{
        const res = await fetch(url + (url.includes('?') ? '&' : '?') + 'cb=' + Date.now(), {
          cache: 'no-store', credentials: 'omit', signal: controller.signal
        });
        if(!res.ok) throw new Error('HTTP ' + res.status);
        return await res.text();
      } finally {
        clearTimeout(id);
      }
    }

    // 区切り自動判定＋空行/コメント(#~)スキップ対応のCSVパーサ
    function parseCSV(text){
      if(!text) return [];
      const trimmed = String(text).replace(/^\s+/, '');
      const firstLine = trimmed.split(/\r\n|\n|\r/, 1)[0] || '';
      const candidates = [',',';','\t'];
      let delim = ','; let maxHits = -1;
      for(const c of candidates){ const hits = (firstLine.match(new RegExp(`\\${c}`, 'g'))||[]).length; if(hits>maxHits){maxHits=hits; delim=c;} }
      const rows=[]; let i=0, field='', row=[], inQ=false;
      while(i<trimmed.length){
        const ch=trimmed[i];
        if(inQ){ if(ch==='"'){ if(trimmed[i+1]==='"'){field+='"'; i+=2; continue;} inQ=false; i++; continue;} field+=ch; i++; continue; }
        if(ch==='"'){ inQ=true; i++; continue; }
        if(ch===delim){ row.push(field); field=''; i++; continue; }
        if(ch==='\n'||ch==='\r'){
          if(ch==='\r'&&trimmed[i+1]=='\n') i++;
          const joined=row.concat(field).join('').trim();
          if(joined!==''){
            const head=(row[0]??field).trim();
            if(!/^#/.test(head)) rows.push(row.concat(field));
          }
          row=[]; field=''; i++; continue;
        }
        field+=ch; i++;
      }
      if(field!==''||row.length){ rows.push(row.concat(field)); }
      return rows.filter(r=> (r.join('').trim()!=='') );
    }

    // ===== CSV→オブジェクト =====
    function csvToNewsObjects(csv){
      const rows = parseCSV(csv);
      if(!rows.length) return [];
      const h = rows[0].map(normalizeHeader);
      const idx = (keys)=>{ for(const k of keys){ const i=h.indexOf(k); if(i!==-1) return i; } return -1; };
      const di = idx(['date','掲載日','更新日','published','publish_date','day']);
      const li = idx(['label','ラベル','タグ','category','type']);
      const ti = idx(['text','本文','お知らせ','内容','body','message','detail','詳細','content']);
      const startAt = 1; // 1行目はヘッダー前提
      return rows.slice(startAt)
        .map(r => ({ date: di>-1 ? String(r[di]||'').trim() : '', label:li>-1 ? String(r[li]||'').trim() : '', text: ti>-1 ? String(r[ti]||'').trim() : '' }))
        .filter(o => o.date || o.text);
    }
    function csvToEventObjects(csv){
      const rows=parseCSV(csv); if(!rows.length) return [];
      const h=rows[0].map(normalizeHeader); const idx=(keys)=>{for(const k of keys){const i=h.indexOf(k); if(i!==-1) return i;} return -1;};
      const ti=idx(['title','タイトル','件名','イベント名','name']);
      const di=idx(['datetext','date','日付','期間','date_text','dates']);
      const ii=idx(['image','画像','img','imageurl','image_url','thumbnail','thumb']);
      const ai=idx(['alt','代替','代替テキスト','alttext','alt_text']);
      const ci=idx(['chip','タグ','tag','ラベル','category']);
      const linki=idx(['link','url','リンク']);
      return rows.slice(1).map(r=>({ title:ti>-1?r[ti]:'', datetext:di>-1?r[di]:'', image:ii>-1?r[ii]:'', alt:ai>-1?r[ai]:'', chip:ci>-1?r[ci]:'', link:linki>-1?r[linki]:'' }))
        .filter(o=> (String(o.title||'').trim()!=='' || String(o.image||'').trim()!==''));
    }
    function csvToScheduleObjects(csv){
      const rows=parseCSV(csv); if(!rows.length) return [];
      let headerRow = rows[0];
      const looksHeader = (r)=> r && r.length>=2 && r.join('').toLowerCase().includes('date');
      if(!looksHeader(headerRow)){
        const idx = rows.findIndex(r=> looksHeader(r));
        if(idx>0) headerRow = rows[idx];
      }
      const h = headerRow.map(s=>{ let t=String(s||''); if(t && t.charCodeAt(0)===0xFEFF) t=t.slice(1); return t.trim().toLowerCase(); });
      const idx=(keys)=>{ for(const k of keys){ const i=h.indexOf(k); if(i!==-1) return i; } return -1; };
      let di=idx(['date','日付','営業日']); let hi=idx(['hours','営業時間','open','openhours']); let ni=idx(['note','メモ','備考','補足']);
      if(di===-1) di=0; if(hi===-1) hi=1; if(ni===-1) ni=2;
      const startAt = rows.indexOf(headerRow)+1;
      return rows.slice(startAt)
        .filter(r => r && r.length>0 && r.join('').trim()!=='')
        .map(r=>({ date: String(r[di]||'').trim(), hours: String(r[hi]||'').trim(), note: String(r[ni]||'').trim() }));
    }

    // ===== 日付パース & 曜日表示 =====
    function parseSheetDateToJsDate(s){
      const raw = String(s ?? '').trim(); if(!raw) return null;
      const maybeNum = Number(raw);
      if(!Number.isNaN(maybeNum) && maybeNum > 20000 && maybeNum < 60000){
        const base = new Date(Date.UTC(1899,11,30));
        return new Date(base.getTime() + maybeNum * 86400000);
      }
      const z2h = (t)=>t.replace(/[０-９]/g, d => String.fromCharCode(d.charCodeAt(0)-0xFEE0));
      let str = z2h(raw).replace(/\u200B|\u200C|\u200D|\uFEFF/g, '').replace(/\u00A0|\u3000/g, ' ').replace(/[（）\(\)]/g, ' ').replace(/[月火水木金土日]曜?/g, ' ').replace(/[年\.]/g, '/').replace(/月/g, '/').replace(/日/g, ' ').replace(/-/g, '/').replace(/\s+/g, ' ').trim();
      const parts = str.includes('/') ? str.split('/') : str.split(' ');
      const nums = parts.map(p => p.trim()).filter(Boolean).flatMap(p => p.match(/\d{1,4}/g) || []);
      if(nums.length >= 3){
        const last = nums.length - 1;
        const d = Number(nums[last]); const m = Number(nums[last-1]); let y = Number(nums[last-2]);
        if(!(y >= 1000 && y <= 9999)) y = new Date().getFullYear();
        if(m>=1 && m<=12 && d>=1 && d<=31) return new Date(`${y}/${m}/${d}`);
      }
      if(nums.length === 2){
        const y = new Date().getFullYear(); const m = Number(nums[0]); const d = Number(nums[1]);
        if(m>=1 && m<=12 && d>=1 && d<=31) return new Date(`${y}/${m}/${d}`);
      }
      const m2 = str.match(/(\d{1,4})[\/ ]?(\d{1,2})[\/ ]?(\d{1,2})/);
      if(m2){
        const y = m2[1].length===4 ? Number(m2[1]) : new Date().getFullYear();
        const m = Number(m2[2]); const d = Number(m2[3]);
        if(m>=1 && m<=12 && d>=1 && d<=31) return new Date(`${y}/${m}/${d}`);
      }
      return null;
    }
    function formatDateJPWithWeekday(rawDateStr){
      const d = parseSheetDateToJsDate(rawDateStr); if(!d) return String(rawDateStr ?? '');
      const wd = ['日','月','火','水','木','金','土'][d.getDay()];
      const y  = d.getFullYear(); const m  = String(d.getMonth()+1).padStart(2,'0'); const dd = String(d.getDate()).padStart(2,'0');
      return `${y}/${m}/${dd}(${wd})`;
    }

    // ===== フォールバック読込（両方試す）
    async function tryLoadCSV(primaryUrl, altUrl){
      try{
        return await fetchTextWithTimeout(primaryUrl, 10000);
      }catch(e){
        try{
          return await fetchTextWithTimeout(altUrl, 10000);
        }catch(e2){
          return '';
        }
      }
    }

    // ===== 描画 =====
    function renderNews(){
      const ul=document.getElementById('newsList'); if(!ul) return;
      const items=(window.PORTAL_DATA.news||[]);
      if(!items.length){ ul.innerHTML = '<li>現在お知らせはありません。</li>'; return; }
      ul.innerHTML=items.map(n=>`<li><time>${escapeHtml(n.date||'')}</time> ${n.label?`<span class="label">${escapeHtml(n.label)}</span>`:''} ${n.text||''}</li>`).join('');
    }
    function renderEvents(){
      const g=document.getElementById('eventsGrid'); if(!g) return;
      const items=(window.PORTAL_DATA.events||[]);
      if(!items.length){ g.innerHTML='<div class="tag">イベントは準備中です。</div>'; return; }
      g.innerHTML=items.map(e=>{
        const img = e.image? `<img src="${e.image}" alt="${escapeHtml(e.alt||e.title||'')}" class="thumb" data-full="${e.image}" loading="lazy">` : '';
        const title = escapeHtml(e.title||'');
        const date = escapeHtml(e.datetext||'');
        const chip = e.chip?`<div class="chip">${escapeHtml(e.chip)}</div>`:'';
        const link = e.link?`<p class="mt-8"><a href="${e.link}" target="_blank" rel="noopener noreferrer">詳細を見る</a></p>`:'';
        return `<article class="card">${img}<div class="body"><h3>${title}</h3><p>${date}</p>${chip}${link}</div></article>`;
      }).join('');
    }
    function renderSchedule(){
      const tbody=document.getElementById('scheduleBody'); if(!tbody) return; const status=document.getElementById('scheduleStatus');
      const all=(window.PORTAL_DATA.schedule||[]);
      const today=new Date(); today.setHours(0,0,0,0); const limit=new Date(today); limit.setDate(today.getDate()+7);
      const inRange=[]; const undated=[];
      for(const r of all){ const d=parseSheetDateToJsDate(r.date); if(!d){ undated.push(r); continue; } d.setHours(0,0,0,0); if(d>=today && d<=limit) inRange.push(r); }
      let rows=inRange.length? inRange : (all.slice(0,7));
      if(!rows.length){ tbody.innerHTML = '<tr><td colspan="3">直近7日間の営業データは未登録です。</td></tr>'; }
      else{
        tbody.innerHTML = rows.map(r => {
          const dateText = formatDateJPWithWeekday(r.date);
          const hours    = String(r.hours || '');
          const note     = String(r.note  || '');
          return `<tr><td>${escapeHtml(dateText)}</td><td>${escapeHtml(hours)}</td><td>${escapeHtml(note)}</td></tr>`;
        }).join('');
      }
      if(status){ status.textContent = `schedule：CSV ${all.length}件（直近7日 ${inRange.length}件 / 日付未解釈 ${undated.length}件）`; }
    }

    // ===== 初期データ =====
    window.PORTAL_DATA={news:[],events:[],schedule:[]};

    function trapFocus(container, first){
      const focusables = container.querySelectorAll('a, button, textarea, input, select, [tabindex]:not([tabindex="-1"])');
      if(!focusables.length) return; const firstEl=first||focusables[0]; const lastEl=focusables[focusables.length-1];
      function onKey(e){
        if(e.key==='Tab'){
          if(e.shiftKey && document.activeElement===firstEl){ e.preventDefault(); lastEl.focus(); }
          else if(!e.shiftKey && document.activeElement===lastEl){ e.preventDefault(); firstEl.focus(); }
        }
        if(e.key==='Escape'){ container.classList.remove('open'); container.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
      }
      container.addEventListener('keydown', onKey);
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      const yearEl=document.getElementById('year'); if(yearEl) yearEl.textContent=new Date().getFullYear();

      const btnMenu=document.getElementById('btnMenu'); const drawer=document.getElementById('drawer'); const btnClose=document.getElementById('btnClose');
      if(btnMenu && drawer && btnClose){
        const toggleDrawer=(open)=>{
          drawer.classList.toggle('open',open);
          drawer.setAttribute('aria-hidden', String(!open));
          btnMenu.setAttribute('aria-expanded', String(open));
          document.body.style.overflow = open? 'hidden':'';
          if(open){ drawer.querySelector('a')?.focus(); trapFocus(drawer, drawer.querySelector('a')); } else { btnMenu.focus(); }
        };
        btnMenu.addEventListener('click',()=>toggleDrawer(true));
        btnClose.addEventListener('click',()=>toggleDrawer(false));
        drawer.addEventListener('click',(e)=>{ if(e.target.tagName==='A') toggleDrawer(false); });
        window.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && drawer.classList.contains('open')) toggleDrawer(false); });
      }

      // === データ読込（プライマリ→フォールバック、タイムアウト＆キャッシュバスター付き）
      try {
        const newsCsv = await tryLoadCSV(window.PORTAL_CONFIG.newsCsvUrl, window.PORTAL_CONFIG.newsCsvUrlAlt);
        window.PORTAL_DATA.news = newsCsv ? csvToNewsObjects(newsCsv) : [];
      } catch(e){ window.PORTAL_DATA.news = []; }

      try {
        const eventsCsv = await tryLoadCSV(window.PORTAL_CONFIG.eventsCsvUrl, window.PORTAL_CONFIG.eventsCsvUrlAlt);
        window.PORTAL_DATA.events = eventsCsv ? csvToEventObjects(eventsCsv) : [];
      } catch(e){ window.PORTAL_DATA.events = []; }

      try {
        const scheduleCsv = await tryLoadCSV(window.PORTAL_CONFIG.scheduleCsvUrl, window.PORTAL_CONFIG.scheduleCsvUrlAlt);
        window.PORTAL_DATA.schedule = scheduleCsv ? csvToScheduleObjects(scheduleCsv) : [];
      } catch(e){ window.PORTAL_DATA.schedule = []; }

      renderNews(); renderEvents(); renderSchedule();

      // 画像ライトボックス
      const lightbox=document.getElementById('lightbox'); const lightImg=document.getElementById('lightboxImg'); const closeBtn=lightbox.querySelector('.close');
      const openLightbox=(src,alt)=>{ lightImg.src=src; lightImg.alt=alt||'拡大画像'; lightbox.classList.add('open'); lightbox.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; };
      const closeLightbox=()=>{ lightbox.classList.remove('open'); lightbox.setAttribute('aria-hidden','true'); lightImg.removeAttribute('src'); document.body.style.overflow=''; };
      const eventsGrid=document.getElementById('eventsGrid');
      if(eventsGrid){ eventsGrid.addEventListener('click',(e)=>{ const img=e.target.closest('img'); if(!img) return; openLightbox(img.getAttribute('data-full')||img.src, img.alt); }); }
      lightbox.addEventListener('click',(e)=>{ if(e.target===lightbox) closeLightbox(); });
      closeBtn.addEventListener('click', closeLightbox);
      window.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && lightbox.classList.contains('open')) closeLightbox(); });

      // モーダル
      const modalTerms=document.getElementById('modalTerms');
      const modalPrivacy=document.getElementById('modalPrivacy');
      const openTerms=document.getElementById('openTerms');
      const openPrivacy=document.getElementById('openPrivacy');
      const toggleModal=(el,open)=>{ if(!el) return; el.classList.toggle('open',open); el.setAttribute('aria-hidden', String(!open)); document.body.style.overflow = open? 'hidden':''; if(open) trapFocus(el, el.querySelector('.close')); };
      if(openTerms)   openTerms.addEventListener('click', (e)=>{ e.preventDefault(); toggleModal(modalTerms,true);   });
      if(openPrivacy) openPrivacy.addEventListener('click', (e)=>{ e.preventDefault(); toggleModal(modalPrivacy,true); });
      document.querySelectorAll('.modal .close').forEach(btn=>{ btn.addEventListener('click',()=>{ const id=btn.getAttribute('data-close'); const el=id? document.getElementById(id) : btn.closest('.modal'); toggleModal(el,false); }); });
      window.addEventListener('keydown',(e)=>{ if(e.key==='Escape'){ toggleModal(modalTerms,false); toggleModal(modalPrivacy,false);} });
      [modalTerms, modalPrivacy].forEach(m=>{ if(m) m.addEventListener('click',(e)=>{ if(e.target===m) toggleModal(m,false); }); });

      // ?embed=true 簡略表示
      const params = new URLSearchParams(location.search);
      if(params.get('embed')==='true'){
        const header=document.querySelector('header'); const footer=document.querySelector('footer');
        if(header) header.style.display='none'; if(footer) footer.style.display='none';
        document.querySelectorAll('section').forEach(s=>s.style.padding='12px 0');
      }
    });
  </script>
  <noscript>JavaScriptが無効になっています。最新情報の読み込みや画像ビューアがご利用いただけません。</noscript>
</body>
</html>
